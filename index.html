<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>World Waternet projects in Palestine</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
  <style>
    body {
      margin: 0;
      height: 100%;
      width: 100%;
      display: flex;
    }
    #map {
      flex-grow: 1;
      height: 100vh;
    }
    /* النافذة الجانبية */
    #sidebar {
      width: 0;
      position: fixed;
      right: 0;
      top: 0;
      height: 100%;
      background: white;
      box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.3);
      overflow-x: hidden;
      transition: 0.4s;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    #sidebar img {
      width: 90%;
      max-width: 350px;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    #sidebar h3 {
      font-size: 24px;
      color: #007BFF;
    }
    #sidebar p {
      font-size: 18px;
      font-weight: bold;
    }
    #close-btn {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 20px;
      cursor: pointer;
      background: #FF0000;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- النافذة الجانبية -->
  <div id="sidebar">
    <button id="close-btn">X</button>
    <h3 id="site-name">اسم الموقع</h3>
    <img id="site-image" src="" alt="">
    <p id="site-description">تفاصيل الموقع</p>
  </div>

  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    const map = L.map("map").setView([32.1, 35.2], 10);

    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      attribution: 'Tiles &copy; Esri'
    }).addTo(map);

    // بيانات المشاريع
    $.getJSON("SalfitProjects.json", function(SP) {
      const blueIcon = L.icon({
        iconUrl: 'blue.png',
        iconSize: [30, 48], 
        iconAnchor: [15, 48],
        popupAnchor: [1, -34],
      });

      const siteDetails = {
        "BluElephant": { img: "BluElephant.png", text: "نظام MBR ذكي لمعالجة مياه الصرف." },
        "Salfeet Municipality": { img: "salfeet_municipality.jpg", text: "تحسين خدمات المياه والبنية التحتية." },
        "Iskaka village council": { img: "iskaka.jpg", text: "تطوير مشاريع المياه والبيئة." },
        "Farkha village council": { img: "farkha.jpg", text: "تحسين جودة المياه والصرف الصحي." },
        "Flowless": { img: "flowless.jpg", text: "مراقبة التسربات وتحسين كفاءة الشبكة." },
        "Purification station": { img: "purification.jpg", text: "محطة معالجة مياه لدعم إعادة الاستخدام." }
      };

      L.geoJson(SP, {
        pointToLayer: function(feature, latlng) {
          const name = feature.properties.Name;
          const details = siteDetails[name] || { img: "default.jpg", text: "لا توجد معلومات متاحة." };

          const marker = L.marker(latlng, { icon: blueIcon });

          // عند النقر على الموقع
          marker.on('click', function () {
            document.getElementById("sidebar").style.width = "400px";
            document.getElementById("site-name").innerText = name;
            document.getElementById("site-image").src = details.img;
            document.getElementById("site-description").innerText = details.text;
          });

          return marker;
        }
      }).addTo(map);
    });

    // زر الإغلاق
    document.getElementById("close-btn").addEventListener("click", function() {
      document.getElementById("sidebar").style.width = "0";
    });
  </script>
</body>
</html>
